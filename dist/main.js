(()=>{"use strict";const e=e=>{const t=document.getElementById(e),o=document.querySelectorAll("button[type=submit]"),n=e[4]-1;o.forEach((e=>e.setAttribute("disabled","disabled"))),document.querySelectorAll("input").forEach((e=>e.addEventListener("input",(()=>{let e=0;for(let o of new FormData(t).entries())""===o[1]&&(e+=1);e?o[n].setAttribute("disabled","disabled"):o[n].removeAttribute("disabled")}))));const a=document.createElement("div");a.style.cssText="font-size: 2rem;",t.appendChild(a),t.addEventListener("submit",(e=>{e.preventDefault(),t.appendChild(a),a.textContent="Загрузка...";const o=new FormData(t);let n={};o.forEach(((e,t)=>{n[t]=e})),fetch("./server.php",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then((e=>{if(200!==e.status)throw new Error(`Что-то пошло не так, код ошибки - ${e.status}`);a.textContent="Спасибо! Мы скоро с вами свяжемся!",r()})).catch((e=>{console.log(e),a.textContent="Что-то пошло не так...",r()}))}));const r=()=>{c(t),a.style.cssText="",o[n].setAttribute("disabled","disabled"),setTimeout((()=>{a.textContent=""}),3e3),"form3"===e&&setTimeout((()=>{document.querySelector(".popup").style.display="none"}),2e3)},c=e=>{e.querySelectorAll("input").forEach((e=>e.value=""))}};(function(e){let t=document.querySelector("#timer-hours"),o=document.querySelector("#timer-minutes"),n=document.querySelector("#timer-seconds");function a(e){return e<10?"0"+e:e}!function e(){let r=(()=>{const e=(new Date("27 march 2021").getTime()-(new Date).getTime())/1e3,t=Math.floor(e%60),o=Math.floor(e/60%60);return{timeRemaining:e,hours:Math.floor(e/60/60),minutes:o,seconds:t}})();t.textContent=a(r.hours),o.textContent=a(r.minutes),n.textContent=a(r.seconds),r.timeRemaining>0?setInterval(e,1e3):(clearInterval(2),t.textContent="00",o.textContent="00",n.textContent="00")}()})(),(()=>{const e=document.querySelector("menu"),t=()=>e.classList.toggle("active-menu");function o(e,t){const o=e.offsetTop;let n,a=0;n=requestAnimationFrame((function e(){var r;n=requestAnimationFrame(e),r=t,a>.95*o&&1!==r?r/=2:o>4e3?r+=3:o>3e3&&(r+=2),a+=20*r,document.documentElement.scrollTop=a,a>o&&(document.documentElement.scrollTop=o,cancelAnimationFrame(n))}))}document.addEventListener("click",(n=>{let a=n.target;if(a.closest("main")&&!e.classList.contains("active-menu"))a.closest(".menu")?t():a.closest('a[href="#service-block"]')&&(n.preventDefault(),o(document.getElementById("service-block"),2));else if(e.classList.contains("active-menu"))if(null===a.closest("menu")||a.classList.contains("close-btn"))t();else if("A"===a.tagName&&!a.classList.contains(".close-btn")){n.preventDefault(),t();const e=a.getAttribute("href").substring(1);o(document.getElementById(e),3)}}))})(),(()=>{const e=document.querySelector(".popup"),t=document.querySelectorAll(".popup-btn"),o=document.querySelector(".popup-close"),n=e.querySelector("form"),a=e.querySelector("div");let r=0;function c(){e.style.display="block",a.style.transform="scale(0)",document.documentElement.clientWidth>=768?(r+=10,a.style.transform=`scale(${r/100})`,r<=100&&requestAnimationFrame(c)):a.style.transform="scale(1)"}function l(){e.style.display="none",r=0}t.forEach((e=>{e.addEventListener("click",(()=>{requestAnimationFrame(c)}))})),e.addEventListener("click",(t=>{t.target!==e&&t.target!==o||l()})),n.addEventListener("submit",l)})(),(()=>{const e=document.querySelector(".service-header"),t=e.querySelectorAll(".service-header-tab"),o=document.querySelectorAll(".service-tab");e.addEventListener("click",(e=>{let n=e.target;n=n.closest(".service-header-tab"),n&&t.forEach(((e,a)=>{e===n&&(e=>{for(let n=0;n<o.length;n++)e===n?(t[n].classList.add("active"),o[n].classList.remove("d-none")):(t[n].classList.remove("active"),o[n].classList.add("d-none"))})(a)}))}))})(),(()=>{const e=document.querySelectorAll(".portfolio-item"),t=document.querySelector(".portfolio-dots"),o=document.querySelector(".portfolio-content");let n,a=0;e.forEach((e=>{let o=document.createElement("li");o.classList.add("dot"),0===e&&o.classList.add("dot-active"),t.appendChild(o)}));const r=document.querySelectorAll(".dot"),c=(e,t,o)=>{e[t].classList.remove(o)},l=(e,t,o)=>{e[t].classList.add(o)},s=()=>{c(e,a,"portfolio-item-active"),c(r,a,"dot-active"),a++,a>=e.length&&(a=0),l(e,a,"portfolio-item-active"),l(r,a,"dot-active")},i=(e=3e3)=>{n=setInterval(s,e)};o.addEventListener("click",(t=>{t.preventDefault();let o=t.target;o.matches(".portfolio-btn, .dot")&&(c(e,a,"portfolio-item-active"),c(r,a,"dot-active"),o.matches("#arrow-right")?a++:o.matches("#arrow-left")?a--:o.matches(".dot")&&r.forEach(((e,t)=>{e===o&&(a=t)})),a>=e.length&&(a=0),a<0&&(a=e.length-1),l(e,a,"portfolio-item-active"),l(r,a,"dot-active"))})),o.addEventListener("mouseover",(e=>{(e.target.matches(".portfolio-btn")||e.target.matches(".dot"))&&clearInterval(n)})),o.addEventListener("mouseout",(e=>{(e.target.matches(".portfolio-btn")||e.target.matches(".dot"))&&i()})),i(1500)})(),document.querySelectorAll("#command .command__photo").forEach((e=>{const t=e.getAttribute("src"),o=e.dataset.img;e.addEventListener("mouseenter",(e=>e.target.src=o)),e.addEventListener("mouseleave",(e=>e.target.src=t))})),(()=>{let e=!1;const t=o=>{o.target.value=o.target.value.replace(/-+(?=-+)| +(?= +)|-+(?= +)| +(?=-+)|^ +| +$|^-+|-+$/gi,""),"user_name"===o.target.name&&(o.target.value=o.target.value.split(" ").map((e=>e[0].toUpperCase()+e.slice(1).toLowerCase())).join(" ")),o.target.removeEventListener("blur",t),e=!e},o=o=>{e||(o.target.addEventListener("blur",t),e=!e)};document.addEventListener("input",(e=>{e.target.matches("input.calc-item")?(e=>{e.target.value=e.target.value.replace(/\D/gi,""),o(e)})(e):"email"===e.target.type?(e=>{e.target.value=e.target.value.replace(/[^a-z@_.!~*'-]/gi,""),o(e)})(e):"tel"===e.target.type?(e=>{e.target.value=e.target.value.replace(/[^\d-()+]/gi,"")})(e):e.target.matches(".mess")?(e=>{e.target.value=e.target.value.replace(/[^а-я- ,.!?'()0-9]/gi,""),o(e)})(e):("text"===e.target.type||e.target.matches("input"))&&(e=>{e.target.value=e.target.value.replace(/[^а-я- ]|-(?=-)| (?= )/gi,""),o(e)})(e)}))})(),((e=100)=>{const t=document.querySelector(".calc-block"),o=document.querySelector(".calc-type"),n=document.querySelector(".calc-square"),a=document.querySelector(".calc-day"),r=document.querySelector(".calc-count"),c=document.getElementById("total");t.addEventListener("change",(t=>{const l=t.target;(l.matches("select")||l.matches("input"))&&(()=>{let t=0,l=1,s=1;const i=o.options[o.selectedIndex].value,u=+n.value;r.value>1&&(l+=(r.value-1)/10),a.value&&a.value<5?s*=2:a.value&&a.value<10&&(s*=1.5),i&&u&&(t=Math.round(e*i*u*l*s));let d=1;const m=()=>{const e=requestAnimationFrame(m);d*=2,c.textContent=d,d>=t&&(c.textContent=t,cancelAnimationFrame(e))};requestAnimationFrame(m),c.textContent=t})()}))})(100),e("form1"),e("form2"),e("form3")})();